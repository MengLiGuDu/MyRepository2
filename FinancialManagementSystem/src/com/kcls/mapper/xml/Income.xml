<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">  
<mapper namespace="com.kcls.mapper.IncomeMapper">
	<select id="select" resultType="com.kcls.bean.IncomeBean">
		select * from kcls_2017_income;
	</select>
	<select id="allMessage" parameterType="com.kcls.bean.Page" resultType="Integer">
		select count(*) from kcls_2017_income where 1 = 1 and income_state = 0 and income_name like '%${searchText}%';
	</select>
	<select id="pageMessage" parameterType="com.kcls.bean.Page" resultType="com.kcls.bean.IncomeBean">
		select (select course_name from kcls_2017_incomeCourse incoc where incoc.course_id = incon.course_id) as course_name,incon.* from kcls_2017_income incon where 1 = 1 and income_state = 0 and income_name like concat('%',#{searchText},'%') limit #{pageNumber},#{pageSize};
	</select>
		
	<insert id="insertIncome" parameterType="com.kcls.bean.IncomeBean">
		insert into kcls_2017_income(
			income_id,
			income_name,
			income_projects,
			course_id,
			accounting_id,
			payment_name,
			payment_unit,
			gathering_name,
			payment_accountNum,
			gathering_accountNum,
			deal_type,
			receipts_money,
			payment_money,
			expenditure_remark,
			Income_evidence,
			create_date,
			income_date,
			income_state
		) value (
			#{income_id},
			#{income_name},
			#{income_projects},
			#{course_id},
			#{accounting_id},
			#{payment_name},
			#{payment_unit},
			#{gathering_name},
			#{payment_accountNum},
			#{gathering_accountNum},
			#{deal_type},
			#{receipts_money},
			#{payment_money},
			#{expenditure_remark},
			#{Income_evidence},
			#{create_date},
			#{income_date},
			#{income_state}
		);
	</insert>
	
	<delete id="deleteIncome" parameterType="com.kcls.bean.IncomeBean">
		delete from kcls_2017_income where income_id = #{income_id};
	</delete>
	
	<select id="selectAccount" resultType="com.kcls.bean.AccountBean">
		select * from kcls_2017_account;
	</select>
	
	
	<select id="accounName" resultType="com.kcls.bean.IncomeSubjectBean">
		select * from kcls_2017_incomeCourse;
	</select>
	
	<update id="updateIncomeState" parameterType="com.kcls.bean.IncomeBean">
		update kcls_2017_income set income_state = 1 where income_id = #{income_id};
	</update>
	
	<select id="updateIncomeList" parameterType="com.kcls.bean.IncomeBean" resultType="com.kcls.bean.IncomeBean">
		select i.*,(select incoc.course_name from kcls_2017_incomeCourse incoc where incoc.course_id = i.course_id) as course_name
		 from kcls_2017_income i where i.income_id = #{income_id};
	</select>
	
	<update id="updateIncome" parameterType="com.kcls.bean.IncomeBean">
		update kcls_2017_income set 
			income_projects = #{income_projects}, 
			course_id = #{course_id}, 
			income_name = #{income_name},
			accounting_id = #{accounting_id},
			payment_name = #{payment_name}, 
			payment_unit = #{payment_unit}, 
			gathering_name = #{gathering_name}, 
			payment_accountNum = #{payment_accountNum}, 
			deal_type = #{deal_type},
			receipts_money = #{receipts_money}, 
			payment_money = #{payment_money}, 
			expenditure_remark = #{expenditure_remark},
			Income_evidence = #{Income_evidence} where income_id = #{income_id};
	</update>
</mapper>