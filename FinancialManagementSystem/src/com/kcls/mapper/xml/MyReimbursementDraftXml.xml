<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">  
<mapper namespace="com.kcls.mapper.MyReimbursementDraftMapeer">

 	<select id="my_reimbursement_draft_list"   resultType="com.kcls.bean.ReimburseBean"    parameterType="com.kcls.bean.Page">
 		
 		
 		
 		<![CDATA[
		    select  *
		     ,(select  course_name  from  kcls_2017_spendingCourse s1  where s1.course_id=r1.course_id ) as  course_name  
		     ,(select  user_name  from  kcls_2017_user   u1  where u1.user_id=r1.budgetName_id ) as  user_name  
		    
 			from   kcls_2017_reimburse   r1  where   1=1
		]]>
 		
 		<include refid="list_sql"></include>
		<if test="pageNumber != null and pageSize != null">
			LIMIT  #{pageNumber} , #{pageSize}
		</if>
 		
 	</select>
 	
 	
 	
 	<insert id="add"  parameterType="com.kcls.bean.ReimburseBean" >
 		insert into  kcls_2017_reimburse  (budget_id,budgetName_id,reimburse_money,course_id,reimburse_title,collection_account,reimburse_date,reimburse_matter,deal_type,cashier_type)  value ( #{budget_id},#{budgetName_id},#{reimburse_money},#{course_id},#{reimburse_title},#{collection_account},#{reimburse_date},#{reimburse_matter},#{deal_type},#{cashier_type}) ;
  	</insert>
 	
 	
 	
 	<sql id="list_sql">
			
		
		<if test="searchText != null">
			<if test="searchText != ''">
				<![CDATA[
							 
					and   reimburse_title      like '%${searchText}%'
					
				]]>
			</if>
		</if>	
		
		
			
			
		<if test="searchText1 != null">
			<if test="searchText1 != ''">
				<![CDATA[
							 
					and   course_id  = #{searchText1}
					
				]]>
			</if>
		</if>
		
		
		 
		
		
		
		
		
		
		
		<if test="searchText3 != null">
			<if test="searchText3 != ''">
				<![CDATA[
							 
					and   budgetName_id  = #{searchText3}
					
				]]>
			</if>
		</if>
		
		
		<if test="searchText4 != null">
			<if test="searchText4 != ''">
				<![CDATA[
							 
					and   cashier_type  = #{searchText4}
					
				]]>
			</if>
		</if>
		
	</sql>
 	
 	
 	<select id="my_reimbursement_draft_count"   resultType="java.lang.Integer"    parameterType="com.kcls.bean.Page">
 			
 		<![CDATA[
 			select  count(*)  from   kcls_2017_reimburse    	 where 1=1  
 		]]>
 		<include refid="list_sql"></include>
		 
 	</select>
 	
 	
 	
 	 
 	
 	
</mapper>