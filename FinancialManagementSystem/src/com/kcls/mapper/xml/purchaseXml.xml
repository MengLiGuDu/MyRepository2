<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">  
<mapper namespace="com.kcls.mapper.PurchaseMapper">

	<select id="getNodesTree" resultType="com.kcls.bean.NodeBean">
		select course_id as node_id,fatherCourse_id as parent_id,course_name as text from kcls_2017_spendingCourse
	</select>
							  
 	<select id="selectPurchase"   resultType="com.kcls.bean.SubScribeBean" parameterType="com.kcls.bean.Page">
 		<![CDATA[
		    select * ,(select course_name from kcls_2017_spendingCourse s1 where s1.course_id=r1.course_id ) as course_name  
 			from   kcls_2017_purchase   r1  where   1=1
		]]>
 		<include refid="list_sql"></include>
		<if test="pageNumber != null and pageSize != null">
			LIMIT  #{pageNumber} , #{pageSize}
		</if>
 	</select>

 	<sql id="list_sql">
		<if test="searchText1 != null">
			<if test="searchText1 != ''">
				<![CDATA[
					and  budgetName_id = #{searchText1}
				]]>
			</if>
		</if>
		<if test="searchText2 != null">
			<if test="searchText2 != ''">
				<![CDATA[
					and  course_id = #{searchText2}
				]]>
			</if>
		</if>
	</sql>
 	<select id="selectCountPurchase" resultType="java.lang.Integer" parameterType="com.kcls.bean.Page">
 		<![CDATA[
 			select count(*) from  kcls_2017_purchase where 1=1  
 		]]>
 		<include refid="list_sql"></include>
 	</select>
	
</mapper>